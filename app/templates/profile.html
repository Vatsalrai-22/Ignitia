{% extends "base.html" %}

{% block title %}Profile Settings{% endblock %}

{% block page_title %}My Profile{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">

<div class="profile-page-container">
    <div class="profile-card">
        <div class="profile-card-header">
            <h1>Personal Information</h1>
            <p>Update your photo and personal details here. This is your digital <strong>identity</strong> on the platform.</p>
        </div>
        <form method="POST" action="{{ url_for('main.profile') }}" enctype="multipart/form-data" class="profile-form">
            {{ form.hidden_tag() }}

            <div class="profile-picture-section">
                {% if current_user.profile_pic_url == 'default-profile-pic.png' %}
                    <img class="profile-picture-display" src="{{ url_for('static', filename='images/' + current_user.profile_pic_url) }}" alt="Profile Picture">
                {% else %}
                    <img class="profile-picture-display" src="{{ url_for('static', filename='profile_pics/' + current_user.profile_pic_url) }}" alt="Profile Picture">
                {% endif %}
                <div class="picture-upload-group">
                    {{ form.picture.label(class="form-label") }}
                    {{ form.picture(class="form-control-file") }}
                </div>
            </div>

            <div class="form-grid">
                <div class="form-group">
                    {{ form.first_name.label(class="form-label") }}
                    {{ form.first_name(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.last_name.label(class="form-label") }}
                    {{ form.last_name(class="form-control") }}
                </div>
            </div>
            
            <div class="form-group">
                {{ form.bio.label(class="form-label") }}
                {{ form.bio(class="form-control", rows="3", placeholder="Tell us a little about yourself...") }}
            </div>

            <hr class="profile-divider">

            <div class="form-grid">
                <div class="form-group">
                    {{ form.username.label(class="form-label") }}
                    {{ form.username(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.email.label(class="form-label") }}
                    {{ form.email(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.role.label(class="form-label") }}
                    {{ form.role(class="form-select") }}
                </div>
                <div class="form-group">
                    {{ form.organization.label(class="form-label") }}
                    {{ form.organization(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.website_url.label(class="form-label") }}
                    {{ form.website_url(class="form-control", placeholder="https://...") }}
                </div>
            </div>
            
            <div class="form-actions">
                <a href="{{ url_for('main.home') }}" class="btn btn-secondary">Cancel</a>
                {{ form.submit(class="btn btn-primary") }}
            </div>
        </form>
    </div>

    <div class="profile-card">
        <div class="delete-account-section">
            <h3>Delete Account</h3>
            <p>Once you delete your account, there is no going back. Please be certain.</p>
            <form method="POST" action="{{ url_for('main.delete_account') }}" onsubmit="return confirm('Are you absolutely sure? This action cannot be undone.');">
                <input type="submit" value="Delete My Account" class="btn btn-danger">
            </form>
        </div>
    </div>
</div>
{% endblock %}